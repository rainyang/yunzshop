{template 'common/header'}
<title>{$yunbi_title}记录</title>
<style type="text/css">
    body {margin:0px; background:#f9f9f9; -moz-appearance:none;font: 12px/1.5 tahoma, "microsoft yahei", "\5FAE\8F6F\96C5\9ED1";}
    a {text-decoration:none;}
    .header {height: auto;padding:0px; background:#f15353;background-size: 100% 100%; padding:10px;position: relative;}
    .header .user {height:100px;text-align: center;}
    .header .user .user-head {height:48px; width:48px; background:#fff; border-radius:50%; border:2px solid #fff;margin: 6px auto;}
    .header .user .user-head img {height:48px; width:48px; border-radius:50%;}
    .header .user .user-info {height:48px; width:100%; float:left;color:#fff;}
    .header .user .user-info .user-name {height:20px; width:auto; font-size:14px; line-height:20px;}
    .header .user .user-info .user-other {height:24px; width:auto; font-size:12px;}
    .header .user .set {position: absolute;right: 10px;top: 10px;color: #fff;font-size: 14px}
    .credit_list {height:auto; width:94%; background:#fff; padding:10px 3%;margin-top:5px;overflow: hidden;}
    .credit_list .info {max-height:80px; width:44% !important; float:left;  font-size:16px; color:#666; line-height:20px; text-align:left;    border-right: 1px solid #eaeaea;}
    .credit_list .info p {font-size:14px; color:#545454;max-height: 40px;overflow: hidden;margin: 0;}
    .credit_list .info span {font-size:14px; color:#999;}
    .credit_list .num {max-height:60px; width:55%;line-height:20px; float:right; text-align:center; font-size:16px; color:#666;}
    .credit_list .num span {font-size:14px; color:#999;}
    .credit_no {height:100px; width:100%; margin:50px 0px 60px; color:#ccc; font-size:12px; text-align:center;}
    #credit_loading { padding:10px;color:#666;text-align: center;}
    .copyright {height:40px; width:100%; text-align:center; line-height:40px; font-size:12px; color:#999; margin-top:10px;}
  
</style>

        <div class="money-center">
            <div class="list1" style="margin-top:0px;border-bottom: 1px solid #ECECEC;">
            <span style="float:left;">{$beneficencename}</span>
                <div class="allorder">
                    <a href="#" class="recharge-ybut">总金额：{$total_money}</a>
                </div>
            </div>
        </div>
    
        <div id="container"> </div>
        <script id='tpl_log' type='text/html'>
            <%each list as log%>
                <div class="credit_list">
                    <div class="info">
                        <p><%log.name%>：贡献<%log.money%></p>
                        
                    </div>
                    <div class="num">
                        <span>时间：<%log.create_time%></span>                   
                    </div>
                </div>
            <%/each%>
        </script>
        <script id='tpl_empty' type='text/html'>
            <div class="credit_no"><i class="fa fa-file-text-o" style="font-size:100px;"></i><br><span style="line-height:18px; font-size:16px;">暂时没有任何记录~</span></div>
        </script>


<div class="copyright">版权所有 ©{if empty($set['shop']['copyright'])}{$set['shop']['name']}{else}{$set['shop']['copyright']}{/if} </div>

<script language="javascript">
    var page = 1;
    var scrolled = false;
    require(['tpl', 'core'], function (tpl, core) {
        function bindScroller(){
            var loaded = false;
            var stop = true;
            $(window).scroll(function () {
                if (loaded) {
                    return;
                }
                totalheight = parseFloat($(window).height()) + parseFloat($(window).scrollTop());
                if ($(document).height() <= totalheight) {
                    if (stop == true) {
                        stop = false; scrolled = true;
                        $('#container').append('<div id="credit_loading"><i class="fa fa-spinner fa-spin"></i> 正在加载...</div>');
                        page++;
                        core.pjson('beneficence/beneficence', {page:page}, function (json) {
                            stop = true;
                            $('#credit_loading').remove();
                            $("#container").append(tpl('tpl_log', json.result));
                            if (json.result.list.length < json.result.pagesize) {
                                $('#credit_loading').remove();
                                $("#container").append('<div id="credit_loading">已经加载完全部记录</div>');
                                loaded = true;
                                $(window).scroll = null;
                                return;
                            }
                        }, true);
                    }
                }
            });
        }
        function getLog() {
            core.pjson('beneficence/beneficence', {page: page}, function (json) { 

                if (json.result.list.length <= 0) {
                    $('#container').html(tpl('tpl_empty'));
                    return;
                }
                $('#container').html(tpl('tpl_log', json.result));
                bindScroller();
            }, true);
        }
        getLog();
    });
</script>


{php $show_footer=true}
{template 'common/footer'}